<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>

</head>

<body id="body">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.10.1/dist/sweetalert2.all.min.js"></script>
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/sweetalert2@10.10.1/dist/sweetalert2.min.css'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
        integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
        crossorigin="anonymous"></script>
    <style>
        #carouselExampleDark {
            margin-top: 20px;

        }

        #img {
            padding-bottom: -200px;
            margin-left: 100px;
            background-color: rgb(0, 0, 0);
        }

        #img2 {
            margin-bottom: 100px;

        }

        .frstimg {
            text-align: center;
            margin-left: 400px;
            margin-bottom: 250px;
            text-align: center;
            width: 1000px;
            color: teal;
        }

        .d-flex {
            float: right;
            margin-right: 10px;
        }

        #showw {
            height: 50px;
        }

        #con {
            text-align: center;
            margin-right: 17%;
            margin-bottom: 15%;

        }

        .mb-3 {

            padding: 10px 10px 10px 10px;
            justify-content: center
        }

        #vl {
            text-decoration: none;
            color: white;
        }

        #div {
            margin-right: 640px;
            align-items: center;
            margin-top: -350px;

        }

        td {
            border: 1px solid rgb(116, 117, 119);
            padding: 10px 10px;
            width: 200px;
        }

        #shows {
            display: none;

        }

        #myTable {
            box-shadow: 3px 5px 5px rgb(134, 134, 134)
        }
    </style>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a id="vl" href="http://localhost:9966/home/logout"> <button class="btn btn-secondary my-2 my-sm-0"
                    type="submit">Logout</button></a>
            <!-- <div class="d-flex">
        <input class="form-control me-sm-2" type="text" placeholder="Search" id="exampleInputEmail2" name="key">
        <button class="btn btn-secondary my-2 my-sm-0" onclick="myfunction()">Search</button>
        <button type="reset" class="btn btn-primary" style="margin-top: 20px;  background-color: rgb(36, 47, 112);"
          id="clear" onclick="clear()">Clear</button>
      </div> -->
        </div>
        </div>
    </nav>

    <div id="carouselExampleDark" class="carousel carousel-dark slide" data-bs-ride="carousel"
        style="margin-top: 0px; ">
        <div class="carousel-inner">
            <div class="carousel-item active" data-bs-interval="10000">
                <img src="https://static9.depositphotos.com/1229718/1167/i/600/depositphotos_11673257-stock-photo-caduceus-medical-symbol.jpg"
                    alt="alt" id="img">
                <div class="carousel-caption d-none d-md-block" id="con">
                    <div class="d-flex">
                        <div class="mb-3" style="margin-top: 100px;padding-top: 100px;">
                            <h2 style="font-size: 300%; color: rgb(54, 50, 28);"><b>Patient Id</b></h2>
                            <!-- <input type="number" class="form-control" id="exampleFormControlInput1"
                placeholder="please enter patient ID" name="key"
                style="margin-bottom: 20px;box-shadow:3px 6px 18px rgb(110, 110, 110)">
              <button class="btn btn-secondary my-2 my-sm-0" type="submit" id="issued" onclick="issued()" value="issued"
                name="status">Issued</button> -->
                            <input class="form-control me-sm-2" type="text" placeholder="Enter patient id"
                                id="exampleInputEmail2" name="key"><br>
                            <div class="d-flex" style="margin-right: 65px;">
                                <button class="btn btn-secondary my-2 my-sm-0" onclick="myfunction()">Search</button>
                                <button type="reset" class="btn btn-secondary my-2 my-sm-0"
                                    style="margin-top: 20px;margin-left: 5px; background-color: rgb(36, 47, 112);"
                                    id="clear" onclick="clear()">Clear</button>
                            </div>
                            <!-- <button class="btn btn-secondary my-2 my-sm-0" type="submit" id="notissued" onclick="notissued()"
                value="notissued" name="status">Not Issued</button> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="div">
        <div id="duv" style="float: right; ">
            <table id="myTable">

            </table>
            <div class="d-flex" style="margin-top: 35px;margin-right: 170px;" id="clr">
                <button class="btn btn-secondary my-2 my-sm-0" name="status" id="shows" type="button" onclick="issue()"
                    value="issued">Issue</button>
            </div>


        </div>

    </div>

    <script>
        function issue() {
            let a = document.getElementById("exampleInputEmail2").value;
            let b = document.getElementById("shows").value;
            console.log(a)
            console.log(b);
            let obj = {
                key: a,
                status: b
            }

            const url = `http://localhost:9966/doctor/publishStatus/${a}/${b}`

            $.ajax({
                url: url,
                type: "GET",
                data: obj,
                dataType: 'json',
                async: true,
                contentType: 'application/json; charset=utf-8'
            }).then(res => {
                console.log("respp:", res);
                //alert("successfully updated patients prescription as issued")
                if (res == "Already issued to this patient!!!") {
                    swal.fire({
                        title: "Already Issued",
                        text: "Already issued to this patient!!!",
                        icon: "error",
                    });
                } else {
                    swal.fire({
                        title: "Success!",
                        text: "You've successfully updated patients prescription details on multichain",
                        icon: "success",
                        button: "Aww yiss!",
                    });
                }
            })
        }

        $(document).ready(function () {
            $("#clear").click(function () {
                $("#myTable").empty();
                document.getElementById('shows').style.display = "none";
            });
        });

        // $(document).ready(function () {
        //     $("button").click(function () {
        //         $("#shows").empty();
        //     });
        // });

        function myfunction() {
            let a = document.getElementById("exampleInputEmail2").value;
            console.log(a, "__")
            let obj = {
                key: a
            }
            const url = `http://localhost:9966/nurse/liststreamkeyitemss/${a}`

            $.ajax({
                url: url,
                type: "GET",
                data: obj,
                dataType: 'json',
                async: true,
                contentType: 'application/json; charset=utf-8'
            }).then(res => {

                console.log("resppppppp:", res);

                if (res == null) {
                    swal.fire({
                        title: "Empty!",
                        text: "No patients in this key!!!",
                        icon: "error",
                    });
                }
                if (res.json != undefined) {
                    if (res.json.name != undefined || res.json != null) {
                        addRowToTable("Time", res.json.time)
                        addRowToTable("Prescription", res.json.prescription)
                        addRowToTable("Mobile", res.json.mobile)
                        addRowToTable("Temperature", res.json.temperature)
                        addRowToTable("Disease", res.json.disease)
                        addRowToTable("Blood pressure", res.json.blood_pressure)
                        addRowToTable("Age", res.json.age);
                        addRowToTable("Name", res.json.name);
                        addRowToTable("ID", res.json.id)
                        addRowToTable("Doctor Name", res.json.doctor_name);
                    }
                    document.getElementById('shows').style.display = "block";
                }
                else if (res.infodetails != undefined) {
                    if (res.infodetails.json.name != null) {
                        console.log("hi");
                        swal.fire({
                            title: "Success!",
                            text: "Issued",
                            icon: "success",
                        });

                        addRowToTable("Status", res.infostatus.json.status)
                        addRowToTable("Time", res.infodetails.json.time)
                        addRowToTable("Prescription", res.infodetails.json.prescription)
                        addRowToTable("Mobile", res.infodetails.json.mobile)
                        addRowToTable("Temperature", res.infodetails.json.temperature)
                        addRowToTable("Disease", res.infodetails.json.disease)
                        addRowToTable("Blood pressure", res.infodetails.json.blood_pressure)
                        addRowToTable("Age", res.infodetails.json.age);
                        addRowToTable("Name", res.infodetails.json.name);
                        addRowToTable("ID", res.infodetails.json.id)
                        addRowToTable("Doctor Name", res.infodetails.json.doctor_name);
                        // document.getElementById('shows').style.display = "block";
                    }
                }
                else {
                    $("#myTable").empty();
                    console.log(res, "____pp")
                    addRowToTable("Time", res.infodetails.json.time)
                    addRowToTable("Prescription", res.infodetails.json.prescription)
                    addRowToTable("Mobile", res.infodetails.json.mobile)
                    addRowToTable("Temperature", res.infodetails.json.temperature)
                    addRowToTable("Disease", res.infodetails.json.disease)
                    addRowToTable("Blood pressure", res.infodetails.json.blood_pressure)
                    addRowToTable("Age", res.infodetails.json.age);
                    addRowToTable("Name", res.infodetails.json.name);
                    addRowToTable("ID", res.infodetails.json.id)
                    addRowToTable("Doctor Name", res.infodetails.json.doctor_name);
                    if (res.infostatus.json.status != undefined) {
                        addRowToTable("Status", res.infostatus.json.status)
                    }
                    document.getElementById('shows').style.display = "block";
                }
            })
        }
        function addRowToTable(left, right) {
            console.log("Table data", left, right);
            var table = document.getElementById("myTable");
            var row = table.insertRow(0);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            cell1.innerHTML = left;
            cell2.innerHTML = right;
        }

        function issued() {
            let a = document.getElementById("exampleFormControlInput1").value;
            let b = document.getElementById("issued").value;
            console.log(a)
            console.log(b);
            let obj = {
                key: a,
                status: b
            }

            const url = `http://localhost:9966/doctor/publishStatus/${a}/${b}`

            $.ajax({
                url: url,
                type: "GET",
                data: obj,
                dataType: 'json',
                async: true,
                contentType: 'application/json; charset=utf-8'
            }).then(res => {
                console.log("respp:", res);
                //alert("successfully updated patients prescription as issued")

                swal.fire({
                    title: "Success!",
                    text: "You've successfully updated patients prescription details on multichain",
                    icon: "success",
                    button: "Aww yiss!",
                });
            })
        }
    </script>
</body>

</html>